#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Pre-push é’©å­ - è¿è¡Œæµ‹è¯•å’Œç±»å‹æ£€æŸ¥
echo "ğŸ§ª è¿è¡Œæµ‹è¯•..."
pnpm test

echo "ğŸ” ç±»å‹æ£€æŸ¥..."
pnpm type-check

# å¦‚æœæœ‰SonarCloud tokenï¼Œè¿è¡Œåˆ†æ
if [ -n "$SONAR_TOKEN" ]; then
    echo "ğŸ” è¿è¡ŒSonarCloudåˆ†æ..."
    pnpm sonar:local
else
    echo "âš ï¸ æœªè®¾ç½®SONAR_TOKENï¼Œè·³è¿‡SonarCloudåˆ†æ"
fi

echo "âœ… Pre-pushæ£€æŸ¥é€šè¿‡ï¼"
